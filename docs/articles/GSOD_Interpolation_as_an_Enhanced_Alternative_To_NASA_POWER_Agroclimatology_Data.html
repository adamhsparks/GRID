<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>glint Use Case • glint</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="glint Use Case">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glint</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/glint.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GSOD_Interpolation_as_an_Enhanced_Alternative_To_NASA_POWER_Agroclimatology_Data.html">glint Use Case</a>
    </li>
    <li>
      <a href="../articles/Getting_started_with_Docker.html">Getting started with Docker</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adamhsparks/glint">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>glint Use Case</h1>
                        <h4 class="author">Adam H. Sparks - Centre for Crop Health, USQ</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adamhsparks/glint/blob/master/vignettes/GSOD_Interpolation_as_an_Enhanced_Alternative_To_NASA_POWER_Agroclimatology_Data.Rmd"><code>vignettes/GSOD_Interpolation_as_an_Enhanced_Alternative_To_NASA_POWER_Agroclimatology_Data.Rmd</code></a></small>
      <div class="hidden name"><code>GSOD_Interpolation_as_an_Enhanced_Alternative_To_NASA_POWER_Agroclimatology_Data.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Global Surface Summary of the Day - GSOD data, <a href="https://data.noaa.gov/dataset/global-surface-summary-of-the-day-gsod">(link)</a> is free, ground-based (or buoy) weather station data with global coverage. When properly cleaned and interpolated this data can provide a better alternative to NASA/POWER for agroclimatology work. This document describes how to reproduce these data using freely available data, software and methodologies.</p>
</div>
<div id="daily-weather-data-cleaning-thin-plate-splining-and-interpolation" class="section level1">
<h1 class="hasAnchor">
<a href="#daily-weather-data-cleaning-thin-plate-splining-and-interpolation" class="anchor"></a>Daily Weather Data Cleaning, Thin Plate Splining and Interpolation</h1>
<p>The <em>glint</em> package makes this process as simple as possible. Described below are the steps that the package uses internally to create gridded weather data from the GSOD data.</p>
<div id="downloading-gsod-data" class="section level2">
<h2 class="hasAnchor">
<a href="#downloading-gsod-data" class="anchor"></a>Downloading GSOD Data</h2>
<p><em>glint</em> offers customised functionality to download GSOD data, <code>get_GSOD()</code> using functionality from the <a href="https://ropensci.github.io/GSODR/"><em>GSODR</em></a> package. <em>glint</em> will provide only the data necessary for interpolation, excluding the other data that GSOD provides while omitting any station that has more than a maximum five missing days to help ensure data quality. The four variables that <em>glint</em> can interpolate are:</p>
<ul>
<li><p>TEMP - Mean daily temperature,</p></li>
<li><p>MAX - Daily maximum temperature,</p></li>
<li><p>MIN - Daily minimum temperature,</p></li>
<li><p>RH - Mean daily relative humidity.</p></li>
</ul>
</div>
<div id="downloading-the-digital-elevation-model" class="section level2">
<h2 class="hasAnchor">
<a href="#downloading-the-digital-elevation-model" class="anchor"></a>Downloading the Digital Elevation Model</h2>
<p><em>glint</em> offers customised functionality, <code><a href="../reference/make_DEM.html">make_DEM()</a></code> to download a digital elevation model based on the Shuttle Radar Topography Mission (SRTM) from <a href="https://wwww.worldclim.org/">WorldClim</a> and aggregated it to:</p>
<ul>
<li><p>1 degree (matching historical <a href="https://power.larc.nasa.gov/">NASA - POWER</a> data, which could provide rainfall),</p></li>
<li><p>0.5 degree (matching <a href="https://power.larc.nasa.gov/">NASA - POWER</a> data, which can provide rainfall),</p></li>
<li><p>0.25 degree (matching <a href="http://chg.geog.ucsb.edu/data/chirps/">CHIRPS</a> data, which can provide rainfall)</p></li>
</ul>
</div>
<div id="interpolating-the-gsod-data" class="section level2">
<h2 class="hasAnchor">
<a href="#interpolating-the-gsod-data" class="anchor"></a>Interpolating the GSOD Data</h2>
<p><em>glint</em> offers a simple function, <code><a href="../reference/interpolate_GSOD.html">interpolate_GSOD()</a></code>, to automate error checking, interpolation and saving GeoTIFF files of the resulting data.</p>
<p>When using the <code><a href="../reference/interpolate_GSOD.html">interpolate_GSOD()</a></code> function, GSOD data are first checked for consistency using <code>boxplot.stats()</code> to identify and remove daily outliers for any variable requested.</p>
<p>Once the GSOD data are cleaned, thin plate splining, the <code>Tps()</code> function, from <em>fields</em> is used to create an object that can then be used to create an interpolated surface of temperatures using the SRTM DEM with the <code>interpolate()</code> function from <em>raster</em>.</p>
<p>The data are then returned in a list of raster stacks by weather variable in the R session or saved to disk in GeoTIFF file format in an INT2S format with LZW compression for saving disk space.</p>
<p>This is an extremely processor and time-intensive process for the entire global data set. It is suggested to use a computer dedicated just to this task, while it will run on a fairly modest desktop, the computer may become unresponsive while performing this operation.</p>
</div>
<div id="example-creating-a-set-of-global-geotiff-files-from-1983-to-2016" class="section level2">
<h2 class="hasAnchor">
<a href="#example-creating-a-set-of-global-geotiff-files-from-1983-to-2016" class="anchor"></a>Example Creating a Set of Global GeoTIFF Files from 1983 to 2016</h2>
<div id="step-1-download-the-gsod-data" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1-download-the-gsod-data" class="anchor"></a>Step 1: Download the GSOD data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">years &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1983</span>, <span class="dt">to =</span> <span class="dv">1984</span>, <span class="dt">by =</span> <span class="dv">1</span>))
<span class="kw">lapply</span>(<span class="dt">X =</span> years, <span class="dt">FUN =</span> make_GSOD_set, <span class="dt">dsn =</span> <span class="st">"/mnt/GSOD"</span>)</code></pre></div>
</div>
<div id="step-2-download-the-digital-elevation-model-and-aggregate-to-0-5-degree" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2-download-the-digital-elevation-model-and-aggregate-to-0-5-degree" class="anchor"></a>Step 2: Download the Digital Elevation Model and Aggregate to 0.5 Degree</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DEM &lt;-<span class="st"> </span><span class="kw"><a href="../reference/make_DEM.html">make_DEM</a></span>(<span class="dt">dsn =</span> <span class="st">"/mnt/DEM"</span>)</code></pre></div>
</div>
<div id="step-3-interpolate-the-gsod-data-from-on-disk-files" class="section level3">
<h3 class="hasAnchor">
<a href="#step-3-interpolate-the-gsod-data-from-on-disk-files" class="anchor"></a>Step 3: Interpolate the GSOD Data from On-disk Files</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">file_list &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">"/mnt/GSOD"</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>For a Unix-type operating system, it is possible to run the process in parallel to reduce the time necessary to generate all variables. This example shows how to run the function and save GTiff files in “~/Cache/GTiff” using threeq cores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GRID &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dt">X =</span> file_list, <span class="dt">FUN =</span> interpolate_GSOD, <span class="dt">dem =</span> DEM,
               <span class="dt">dsn =</span> <span class="st">"/mnt/Cache/GTiff"</span>, <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">"MAX"</span>, <span class="st">"MIN"</span>), <span class="dt">cores =</span> <span class="dv">3</span>)</code></pre></div>
<div id="using-a-single-core-on-windows" class="section level4">
<h4 class="hasAnchor">
<a href="#using-a-single-core-on-windows" class="anchor"></a>Using a Single Core on Windows</h4>
<p>If a Windows operating system is detected, the function will automatically default to using a single core for the processes as Windows does not support the parallel procedures that it uses. No need to specify the cores here, will default to one. If set to higher than one, it will automatically reset to one to run.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GRID &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dt">X =</span> file_list, <span class="dt">FUN =</span> interpolate_GSOD, <span class="dt">dem =</span> dem,
<span class="dt">dsn =</span> <span class="st">"~/Cache/GTiff"</span>, <span class="dt">vars =</span> <span class="kw">c</span>(<span class="st">"MAX"</span>, <span class="st">"MIN"</span>))</code></pre></div>
<hr>
</div>
</div>
</div>
</div>
<div id="appendices" class="section level1">
<h1 class="hasAnchor">
<a href="#appendices" class="anchor"></a>Appendices</h1>
<div id="reproducibility" class="section level2">
<h2 class="hasAnchor">
<a href="#reproducibility" class="anchor"></a>Reproducibility</h2>
<pre><code>## ─ Session info ──────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 3.5.1 (2018-07-02)
##  os       Ubuntu 18.04.1 LTS          
##  system   x86_64, linux-gnu           
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  ctype    en_US.UTF-8                 
##  tz       Etc/UTC                     
##  date     2018-11-19                  
## 
## ─ Packages ──────────────────────────────────────────────────────────────
##  package     * version    date       lib source                     
##  assertthat    0.2.0      2017-04-11 [1] CRAN (R 3.5.1)             
##  backports     1.1.2      2017-12-13 [1] CRAN (R 3.5.1)             
##  cli           1.0.1.9000 2018-11-19 [1] Github (r-lib/cli@56538e3) 
##  commonmark    1.6        2018-09-30 [1] CRAN (R 3.5.1)             
##  crayon        1.3.4      2017-09-16 [1] CRAN (R 3.5.1)             
##  desc          1.2.0      2018-11-19 [1] Github (r-lib/desc@7c12d36)
##  digest        0.6.18     2018-10-10 [1] CRAN (R 3.5.1)             
##  evaluate      0.12       2018-10-09 [1] CRAN (R 3.5.1)             
##  fs            1.2.6      2018-08-23 [1] CRAN (R 3.5.1)             
##  htmltools     0.3.6      2017-04-28 [1] CRAN (R 3.5.1)             
##  knitr         1.20       2018-02-20 [1] CRAN (R 3.5.1)             
##  magrittr      1.5        2014-11-22 [1] CRAN (R 3.5.1)             
##  MASS          7.3-51.1   2018-11-01 [3] CRAN (R 3.5.1)             
##  memoise       1.1.0      2017-04-21 [1] CRAN (R 3.5.1)             
##  pkgdown       1.1.0      2018-06-02 [1] CRAN (R 3.5.1)             
##  R6            2.3.0      2018-10-04 [1] CRAN (R 3.5.1)             
##  Rcpp          1.0.0      2018-11-07 [1] CRAN (R 3.5.1)             
##  rlang         0.3.0.1    2018-10-25 [1] CRAN (R 3.5.1)             
##  rmarkdown     1.10       2018-06-11 [1] CRAN (R 3.5.1)             
##  roxygen2      6.1.1      2018-11-07 [1] CRAN (R 3.5.1)             
##  rprojroot     1.3-2      2018-01-03 [1] CRAN (R 3.5.1)             
##  sessioninfo   1.1.1      2018-11-05 [1] CRAN (R 3.5.1)             
##  stringi       1.2.4      2018-07-20 [1] CRAN (R 3.5.1)             
##  stringr       1.3.1      2018-05-10 [1] CRAN (R 3.5.1)             
##  withr         2.1.2      2018-03-15 [1] CRAN (R 3.5.1)             
##  xml2          1.2.0      2018-01-24 [1] CRAN (R 3.5.1)             
##  yaml          2.2.0      2018-07-25 [1] CRAN (R 3.5.1)             
## 
## [1] /usr/local/lib/R/site-library
## [2] /usr/lib/R/site-library
## [3] /usr/lib/R/library</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#daily-weather-data-cleaning-thin-plate-splining-and-interpolation">Daily Weather Data Cleaning, Thin Plate Splining and Interpolation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#downloading-gsod-data">Downloading GSOD Data</a></li>
      <li><a href="#downloading-the-digital-elevation-model">Downloading the Digital Elevation Model</a></li>
      <li><a href="#interpolating-the-gsod-data">Interpolating the GSOD Data</a></li>
      <li><a href="#example-creating-a-set-of-global-geotiff-files-from-1983-to-2016">Example Creating a Set of Global GeoTIFF Files from 1983 to 2016</a></li>
      </ul>
</li>
      <li>
<a href="#appendices">Appendices</a><ul class="nav nav-pills nav-stacked">
<li><a href="#reproducibility">Reproducibility</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Adam H. Sparks, Andrew Nelson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
